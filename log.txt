[2022-03-23T19:06:28Z INFO  ats_monitoring] starting up ats-monitoring app
[2022-03-23T19:06:28Z INFO  ats_monitoring] please wait for connecting to plc
[2022-03-23T19:06:28Z DEBUG tokio_postgres::simple_query] executing statement batch: alter database postgres set default_transaction_isolation to serializable
[2022-03-23T19:06:28Z DEBUG tokio_postgres::simple_query] executing statement batch: 
                    CREATE TABLE IF NOT EXISTS avr_control_insert (
                        mains_power_supply int NOT NULL,
                        start_generator int NOT NULL,
                        generator_faulty int NOT NULL,
                        generator_work int NOT NULL,
                        connection int NOT NULL,
                        mark timestamptz default current_timestamp
                    )
                
[2022-03-23T19:06:28Z INFO  postgres::config] NOTICE: relation "avr_control_insert" already exists, skipping
[2022-03-23T19:06:28Z DEBUG tokio_postgres::simple_query] executing statement batch: 
                    CREATE TABLE IF NOT EXISTS журнал_работы_приложения (
                        событие text NOT NULL,
                        время_и_дата timestamp default current_timestamp
                    )
                
[2022-03-23T19:06:28Z INFO  postgres::config] NOTICE: relation "журнал_работы_приложения" already exists, skipping
[2022-03-23T19:06:28Z DEBUG tokio_postgres::simple_query] executing statement batch: 
                    CREATE TABLE IF NOT EXISTS зимний_сад (
                        фитоосвещение_1 int NOT NULL,
                        фитоосвещение_2 int NOT NULL,
                        фитоосвещение_3 int NOT NULL,
                        фитоосвещение_4 int NOT NULL,
                        вентилятор int NOT NULL,
                        автополив_1 int NOT NULL,
                        автополив_2 int NOT NULL,
                        автополив_3 int NOT NULL,
                        температура int NOT NULL,
                        влажность int NOT NULL,
                        освещенность_в_помещении int NOT NULL,
                        освещенность_на_улице int NOT NULL,
                        время_и_дата timestamp default current_timestamp
                    )
                
[2022-03-23T19:06:28Z INFO  postgres::config] NOTICE: relation "зимний_сад" already exists, skipping
[2022-03-23T19:06:28Z DEBUG tokio_postgres::simple_query] executing statement batch: 
                    CREATE TABLE IF NOT EXISTS нагрузка_на_генератор (
                        нагрузка int NOT NULL,
                        время_и_дата timestamp default current_timestamp
                    
                    )
                
[2022-03-23T19:06:28Z INFO  postgres::config] NOTICE: relation "нагрузка_на_генератор" already exists, skipping
[2022-03-23T19:06:28Z DEBUG tokio_postgres::simple_query] executing statement batch: 
                    CREATE TABLE IF NOT EXISTS события_авр (
                        событие text NOT NULL,
                        время_и_дата timestamp default current_timestamp
                    )
                
[2022-03-23T19:06:28Z INFO  postgres::config] NOTICE: relation "события_авр" already exists, skipping
[2022-03-23T19:06:28Z INFO  ats_monitoring] starting up write_data_to_ram_spawn
[2022-03-23T19:06:28Z INFO  ats_monitoring] starting up modbus_ats_spawn
[2022-03-23T19:06:28Z INFO  ats_monitoring] starting up modbus_winter_garden_spawn
[2022-03-23T19:06:28Z INFO  ats_monitoring] starting up power_supply_monitoring_spawn
[2022-03-23T19:06:28Z INFO  ats_monitoring] starting up generator_monitoring_spawn
[2022-03-23T19:06:28Z INFO  ats_monitoring::power_supply_monitoring::power_supply] Ошибка! Связь СУБД PostgreSQL с Modbus клиентом отсутствует!
[2022-03-23T19:06:28Z INFO  ats_monitoring::generator_monitoring::generator] Ошибка! Связь СУБД PostgreSQL с Modbus клиентом отсутствует!
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s0: SELECT EXTRACT(epoch FROM mark) FROM avr_control_insert ORDER BY mark DESC limit 1
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s1: INSERT INTO журнал_работы_приложения (событие) VALUES ($1)
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s2: INSERT INTO журнал_работы_приложения (событие) VALUES ($1)
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s1 with parameters: ["Ошибка! Связь СУБД PostgreSQL с Modbus клиентом отсутствует!"]
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s0 with parameters: []
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s2 with parameters: ["Ошибка! Связь СУБД PostgreSQL с Modbus клиентом отсутствует!"]
[2022-03-23T19:06:28Z INFO  ats_monitoring::ram::db] Time (unix) of the last entry in a table 'avr_control_insert': Postgres = 1647974359.331092, Skytable = 0
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s3: SELECT событие, время_и_дата FROM журнал_работы_приложения ORDER BY время_и_дата DESC limit 1
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s3 with parameters: []
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s4: SELECT EXTRACT(epoch FROM now()) FROM avr_control_insert ORDER BY now() DESC limit 1
[2022-03-23T19:06:28Z INFO  ats_monitoring::psql::postgresql] Запись в табл. журнал_работы_приложения: Ошибка! Связь СУБД PostgreSQL с Modbus клиентом отсутствует!
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s4 with parameters: []
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s5: SELECT событие, время_и_дата FROM журнал_работы_приложения ORDER BY время_и_дата DESC limit 1
[2022-03-23T19:06:28Z INFO  ats_monitoring::ram::db] Time (unix) now: PostgreSQL = 1648062388.081524, Skytable = 1000
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s5 with parameters: []
[2022-03-23T19:06:28Z INFO  ats_monitoring::psql::postgresql] Запись в табл. журнал_работы_приложения: Ошибка! Связь СУБД PostgreSQL с Modbus клиентом отсутствует!
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s6: SELECT mark, connection FROM avr_control_insert ORDER BY mark DESC limit 1
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s6 with parameters: []
[2022-03-23T19:06:28Z INFO  ats_monitoring::ram::db] Latest value of plc_connect: PostgreSQL = 1, Skytable = 2
[2022-03-23T19:06:28Z DEBUG tokio_postgres::prepare] preparing query s7: SELECT mark, generator_faulty FROM avr_control_insert ORDER BY mark DESC limit 1
[2022-03-23T19:06:28Z DEBUG tokio_postgres::query] executing statement s7 with parameters: []
[2022-03-23T19:06:28Z INFO  ats_monitoring::ram::db] Latest value of generator_faulty: PostgreSQL = 0, Skytable = 2
[2022-03-23T19:06:31Z INFO  ats_monitoring] starting up write_data_to_ram_spawn
[2022-03-23T19:06:31Z DEBUG tokio_postgres::prepare] preparing query s8: SELECT EXTRACT(epoch FROM mark) FROM avr_control_insert ORDER BY mark DESC limit 1
[2022-03-23T19:06:31Z DEBUG tokio_postgres::query] executing statement s8 with parameters: []
[2022-03-23T19:06:31Z INFO  ats_monitoring::ram::db] Time (unix) of the last entry in a table 'avr_control_insert': Postgres = 1647974359.331092, Skytable = 0
[2022-03-23T19:06:31Z DEBUG tokio_postgres::prepare] preparing query s9: SELECT EXTRACT(epoch FROM now()) FROM avr_control_insert ORDER BY now() DESC limit 1
[2022-03-23T19:06:31Z DEBUG tokio_postgres::query] executing statement s9 with parameters: []
[2022-03-23T19:06:31Z INFO  ats_monitoring::ram::db] Time (unix) now: PostgreSQL = 1648062391.10759, Skytable = 1000
[2022-03-23T19:06:31Z DEBUG tokio_postgres::prepare] preparing query s10: SELECT mark, connection FROM avr_control_insert ORDER BY mark DESC limit 1
[2022-03-23T19:06:31Z DEBUG tokio_postgres::query] executing statement s10 with parameters: []
[2022-03-23T19:06:31Z INFO  ats_monitoring::ram::db] Latest value of plc_connect: PostgreSQL = 1, Skytable = 2
[2022-03-23T19:06:31Z DEBUG tokio_postgres::prepare] preparing query s11: SELECT mark, generator_faulty FROM avr_control_insert ORDER BY mark DESC limit 1
[2022-03-23T19:06:31Z DEBUG tokio_postgres::query] executing statement s11 with parameters: []
[2022-03-23T19:06:31Z INFO  ats_monitoring::ram::db] Latest value of generator_faulty: PostgreSQL = 0, Skytable = 2
